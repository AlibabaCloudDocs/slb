# Perform health check diagnostics

This topic describes how to perform health check diagnostics. Server Load Balancer \(SLB\) provides health check diagnostics on backend servers \(ECS instances\). This feature is used to detect the health status of backend servers after you configure backend servers for a listener. This feature is implemented by using Cloud Assistant to run detection scripts on backend servers. The scripts are generated by SLB based on the health check configurations of the listener.

Before you perform health check diagnostics, make sure that the following conditions are met:

-   Permissions are granted to SLB to perform health check diagnostics on ECS instances. To grant permissions, go to the [RAM role authorization page](https://ram.console.aliyun.com/roles/).
-   The backend server to be checked must be a VPC-type ECS instance that is installed with a Linux system and the Cloud Assistant client. The ECS instance is in the running state and the default shell is bash.
-   Health check is enabled on the SLB listener. ECS instances are added to the backend server group.

Before you perform health check diagnostics, take note of the following items:

-   Backend servers monitored by listeners that have forwarding rules configured do not support health check diagnostics.
-   Because the health check diagnostics feature and the SLB health check feature use different links, their health check results may be different. Health check diagnostics provides you with suggestions on health check configurations, while health checks are performed based on health check configurations.

1.  Log on to the [Server Load Balancer console](https://slb.console.aliyun.com/slb).

2.  Find the SLB instance for which you want to perform health check diagnostics on backend servers and click the instance ID.

3.  Click the **Listeners** tab, find the listener that you want to manage, and then click **Modify Listener** in the **Actions** column.

4.  On the **Configure Listener** page, click **Next** till the **Health Check** step appears.

5.  Click **Health Precheck** in the **Advanced** section.

6.  Find the backend server to be diagnosed, and click **Diagnose** in the **Actions** column.

    To perform health check diagnostics on multiple ECS instances at a time, select the ECS instances and click **Batch Precheck**. Up to five ECS instances can be selected at a time. If you want to perform health check diagnostics on more than five ECS instances, you can perform multiple health checks.

7.  Click **OK** to start the diagnostics. After the diagnostics is complete, the console displays the result.

    ![](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/en-US/7885126751/p67838.png)

    Listeners support the following diagnostic items:

    |Listener type|Health check port status|iptables configuration|rpfilter configuration|HTTP probe response|UDP probe|
    |-------------|------------------------|----------------------|----------------------|-------------------|---------|
    |TCP|√|√|√|√|-|
    |UDP|√|√|√|-|√|
    |HTTP|√|√|√|√|-|
    |HTTPS|√|√|√|√|-|

    To query the script execution details, log on to the [Cloud Assistant](https://ecs.console.aliyun.com/?spm=5176.11783240.aliyun_sidebar.10.b6901eb95Lqnz0#/cloudAssistant/region/cn-beijing) console, select the region where the ECS instance is deployed, and then click the **Tasks** tab.


