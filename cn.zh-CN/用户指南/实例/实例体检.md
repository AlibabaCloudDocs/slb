# 实例体检

负载均衡支持对实例从健康检查、云盾状态、证书状态、访问控制、费用和是否为闲置实例六个方面进行检测，并提供异常的产生原因和常见处理方法。

## 实例体检

完成以下操作，可以从健康检查、云盾状态、证书状态、访问控制、费用和闲置实例六个角度对实例进行体检：

1.  登录[负载均衡管理控制台](https://slb.console.aliyun.com/slb)。

2.  在左侧导航栏，选择**实例** \> **实例管理**。

3.  单击需要体检实例**实例体检**列的![](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/4275597751/p61023.png)或者单击需要体检的实例ID，在实例详情页面，单击右上角的**实例体检**。

4.  在实例体检详情页面，您可以看到实例的体检结果，如果有异常项，会提供异常原因和处理方法。

    ![实例体检](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6302382061/p174210.png)

5.  单击**确定**。


## 健康检查诊断

SLB健康检查诊断功能的主要原理是根据SLB监听上的健康检查配置生成诊断脚本，通过ECS云助手在您的ECS上执行脚本得到健康诊断结果，并提供异常的产生原因和常见处理方法。您需要满足以下条件，才能对后端服务器进行健康检查诊断：

-   确保您已经授权负载均衡对ECS实例进行健康检查诊断，才能使用健康检查诊断功能，授权请单击[RAM角色授权](https://ram.console.aliyun.com/roles/)。

    ![RAM角色管理](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6302382061/p174214.png)

-   后端服务器必须是VPC类型并且安装了Linux系统的ECS实例，并且安装了云助手，实例处于running状态，系统默认shell为bash。
-   负载均衡监听已开启健康检查并且后端服务器组中存在健康检查异常的ECS实例。

健康检查诊断相关说明如下：

-   目前不支持对转发规则的后端服务器进行诊断。
-   健康检查诊断为您提供可能导致健康检查异常的原因。

1.  实例体检完成后，如果健康检查状态异常，单击**健康检查**。

2.  单击**操作**列的**开始检测**，查看健康检查异常具体原因和处理方法。

    目前监听健康检查支持的诊断项如下，您可以同时诊断5台云服务器，如果后端服务器数量过大，请分批进行诊断：

    |监听类型|健康检查端口状态|iptables配置|rpfilter配置|HTTP探测响应|UDP探测|
    |----|--------|----------|----------|--------|-----|
    |TCP|√|√|√|√|-|
    |UDP|√|√|√|-|√|
    |HTTP|√|√|√|√|-|
    |HTTPS|√|√|√|√|-|

3.  您可以登录[云助手](https://ecs.console.aliyun.com/?spm=5176.11783240.aliyun_sidebar.10.b6901eb95Lqnz0#/cloudAssistant/region/cn-beijing)，选择ECS实例所在的地域，单击**执行记录**页签，查询脚本诊断执行详情。


