---
keyword: [服务器组, 监听, 后端服务器, ECS, 应用型负载均衡]
---

# 管理服务器组

在使用应用型负载均衡服务前，您必须创建服务器组并至少添加一台后端服务器来接收负载均衡转发的客户端请求。默认情况下，应用型负载均衡使用您为服务器组指定的端口和协议将请求发送到已注册的后端服务器。

-   在向服务器组添加ECS实例前，确保您已创建了ECS实例并部署了相关应用，用来接收转发的请求。
-   要将流量路由到服务器组中的后端服务器，请在创建监听或监听转发规则时指定服务器组。更多信息，请参见[管理监听转发规则](/cn.zh-CN/应用型负载均衡ALB/应用型负载均衡用户指南/应用型负载均衡监听/管理监听转发规则.md)。

## 创建服务器组

完成以下操作，创建服务器组。

1.  登录[负载均衡管理控制台](https://slb.console.aliyun.com/slb)。

2.  在左侧导航栏，选择**应用型负载均衡ALB** \> **服务器组**。

3.  在服务器组页面，单击**创建服务器组**。

4.  完成以下配置，然后单击**创建**。

    |配置|说明|
    |--|--|
    |**服务器组名称**|输入服务器组名称。长度为2~128个字符，必须以大小写字母或中文开头，可包含数字、英文句点（.）、下划线（\_）和短划线（-）。|
    |**VPC**|从VPC下拉列表中选择一个VPC。只有该VPC下的服务器可以加入到该服务器组。|
    |**选择后端协议**|选择一种后端协议：    -   **HTTP**（默认）：关联HTTPS、HTTP和QUIC监听。
    -   **HTTPS**：关联HTTPS监听。 |
    |**选择调度算法**|选择一种调度算法：    -   **加权轮询**：权重值越高的后端服务器，被轮询到的次数（概率）也越高。
    -   **加权最小连接数**：除了根据每台后端服务器设定的权重值来进行轮询，同时还考虑后端服务器的实际负载（即连接数）。当权重值相同时，当前连接数越小的后端服务器被轮询到的次数（概率）也越高。
    -   **源IP一致性哈希**：相同的源地址会调度到相同的后端服务器。 |
    |**开启会话保持**|开启或关闭会话保持。开启会话保持功能后，负载均衡会把来自同一客户端的访问请求分发到同一台后端服务器上进行处理。|
    |**Cookie处理方式**|选择一种Cookie处理方式：    -   **植入Cookie**：客户端第一次访问时，负载均衡会在返回请求中植入Cookie（即在HTTP或HTTPS响应报文中插入SERVERID），下次客户端携带此Cookie访问，负载均衡服务会将请求定向转发给之前记录到的后端服务器上。
    -   **重写Cookie**：负载均衡发现用户自定义了Cookie，将会对原来的Cookie进行重写，下次客户端携带新的Cookie访问，负载均衡服务会将请求定向转发给之前记录到的后端服务器。
**说明：** 此参数仅在开启会话保持功能后生效。 |
    |**会话保持超时时间**|输入会话保持的超时时间，取值范围为1~86400秒。**说明：** 此参数仅在开启会话保持功能后生效。 |
    |**配置健康检查**|开启或关闭健康检查。|
    |高级配置|
    |**选择并加载健康检查**|选择并加载一个健康检查。**说明：** 您可以创建健康检查，不与服务器组及监听关联，方便下次复用。 |
    |**健康检查协议**|选择健康检查协议类型：    -   **HTTP**：通过发送HEAD/GET请求模拟浏览器的访问行为来检查服务器应用是否健康。
    -   **TCP**：通过发送SYN握手报文来检测服务器端口是否存活。 |
    |**健康检查方法**|选择一种健康检查方法：HEAD或GET。    -   **HEAD**：HTTP监听健康检查默认采用HEAD方法。请确保您的后端服务器支持HEAD请求。如果您的后端应用服务器不支持HEAD方法或HEAD方法被禁用，则可能会出现健康检查失败，此时可以使用GET方法来进行健康检查。
    -   **GET**：如果响应报文长度超过8K，会被截断，但不会影响健康检查结果的判定。
**说明：** 此参数仅在健康检查协议为**HTTP协议**时生效。 |
    |**健康检查协议版本**|选择一个HTTP协议版本：**HTTP1.0**或**HTTP1.1**。**说明：** 此参数仅在健康检查协议为**HTTP协议**时生效。 |
    |**健康检查端口**|选择健康检查服务访问后端时的探测端口。    -   **后端服务器组端口**：默认使用后端服务器的端口进行健康检查。
    -   **指定特定端口**：指定一个特定的端口进行健康检查。取值范围为1~65535。 |
    |**健康检查路径**|输入健康检查页面的URL。长度限制为1~80个字符，支持使用字母、数字和短划线（-）、正斜线（/）、英文句点（.）、百分号（%）、问号（?）、井号（\#）和and（&）以及扩展字符集`_;~!（)*[]@$^:',+`。URL必须以正斜线（/）开头。|
    |**健康检查域名**|输入健康检查的域名。    -   **使用后端服务器的内网IP**（默认）：使用后端服务器的内网IP地址作为健康检查的域名。
    -   **指定特定域名**：输入一个域名。长度为1~80个字符，只能使用小写字母、数字、英文句点（.）和短划线（-）。域名中至少包含一个英文句点（.）。英文句点（.）不能出现在开头或结尾。 |
    |**健康状态返回码**|选择健康检查正常的HTTP状态码：**http\_2xx**（默认）、 **http\_3xx**、**http\_4xx**或**http\_5xx**。**说明：** 此参数仅在健康检查协议为**HTTP协议**时生效。 |
    |**响应超时时间**|输入接收来自运行状况检查的响应需要等待的时间。如果后端ECS在指定的时间内没有正确响应，则判定为健康检查失败。 取值范围是1~300秒，默认为5秒。 |
    |**间隔时间**|输入进行健康检查的时间间隔。 取值范围1~50秒，默认为2秒。 |
    |**健康阈值**|健康检查连续成功多少次后，将后端服务器的健康检查状态由失败判定为成功的次数。 可选值2~10，默认为3次。 |
    |**不健康阈值**|健康检查连续失败多少次后，将后端服务器的健康检查状态由成功判定为失败的次数。 可选值 2~10，默认为2次。 |
    |**将新的配置保存为健康检查模板，方便下次快速复制使用。**|选择将新的配置保存为健康检查模板。|


## 添加后端服务器

在创建后端服务器组之后，你需要添加后端服务器来处理转发请求。

1.  登录[负载均衡管理控制台](https://slb.console.aliyun.com/slb)。

2.  在左侧导航栏，选择**应用型负载均衡ALB** \> **服务器组**。

3.  在服务器组页面，单击刚创建的服务器组**操作**列下的**编辑后端服务器**。

4.  单击**后端服务器**页签下的**添加后端服务器**。

5.  在我的服务器面板，选择后端服务器类型，选中目标服务器，然后单击**下一步**。

6.  在配置端口和权重面板，指定添加的服务器的端口和权重，然后单击**添加**。

    权重默认为100，权重越高的服务器将被分配到更多的访问请求。如开启会话保持，可能会造成后端服务器的请求不均匀。

    您可以鼠标浮动至![批量操作](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/0101189061/p208921.png)批量修改服务器的权重：

    -   单击**向下复制**：如果修改当前服务器的权重，该服务器以下所有服务器的权重同步改变。
    -   单击**向上复制**：如果修改当前服务器的权重，该服务器以上所有服务器的权重同步改变。
    -   单击**全部复制**：如果修改当前服务器的权重，该服务器组中所有服务器的权重同步改变。
    -   单击权重右侧的**重置**：将服务器组中所有服务器的权重重组置为默认。
    **说明：** 如果权重设置为0，该服务器不会再接受新请求。

7.  单击**添加**。


## 删除服务器组

如果一个服务器组未被任何监听转发规则的转发操作引用，则可以删除该服务器组。删除服务器组不会影响已注册到服务器组的服务器。如果您不再需要已注册的 ECS实例，则可以停止或终止该实例。

1.  登录[负载均衡管理控制台](https://slb.console.aliyun.com/slb)。

2.  在左侧导航栏，选择**应用型负载均衡ALB** \> **服务器组**。

3.  单击目标服务器组**操作**列下的**删除**。

4.  单击**确定**。


