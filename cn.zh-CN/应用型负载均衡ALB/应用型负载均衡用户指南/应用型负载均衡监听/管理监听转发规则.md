---
keyword: [监听, 转发规则, 应用型负载均衡实例, 后端路由器]
---

# 管理监听转发规则

您可以定义应用型负载均衡实例的监听转发规则，确定应用型负载均衡实例如何将请求路由到一个或多个后端服务器组中的后端服务器。

每条转发规则由优先级、一个或多个条件以及一个或多个动作组成。您在定义转发规则前，确保满足以下条件：

-   每条规则可以包括以下条件中的一个或多个：**域名**、**路径**、**HTTP标头**、**查询字符串**、**HTTP请求方法**和**Cookie**。
-   一个转发规则必须包含有一条转发、重定向或返回固定响应类型的转发动作。
-   **转发至**动作将请求路由到后端服务器组。在添加`转发至`动作之前，请创建后端服务器组并向其添加后端服务器。具体操作，请参见[管理服务器组](/cn.zh-CN/应用型负载均衡ALB/应用型负载均衡用户指南/应用型负载均衡服务器组/管理服务器组.md)。

## 添加转发规则

您可以在创建监听时定义默认转发规则，并可随时添加转发规则。

完成以下操作，添加转发规则。

1.  登录[负载均衡管理控制台](https://slb.console.aliyun.com/slb)。

2.  在左侧导航栏，选择**应用型负载均衡ALB** \> **实例**。

3.  在实例页面，单击目标实例ID。

4.  单击**监听**页签。

5.  单击目标监听**操作**列下的**查看/编辑转发规则**。

6.  在转发规则页面，单击**插入新规则**。

7.  在插入转发规则对话框，完成以下配置，然后单击**确定**。

    |配置|说明|
    |--|--|
    |**规则名称**|输入规则名称。 长度为2~128个英文或中文字符，必须以大小字母或中文开头，可包含数字、英文句点（.）、下划线（\_）和短划线（-）。同一个监听内不同规则的名称必须唯一。|
    |**添加转发条件**|添加一个或多个以下条件：    -   **域名**：选择**添加转发条件** \> **域名**，然后输入一个或多个域名（例如，`*.example.com`）。

**说明：** 域名长度限制为3~128个字符，只允许包含字母、数字、短划线（-）和英文句点（.）这些特殊字符，支持星号（\*）和问号（?）作为通配符使用。

    -   **路径**：选择**添加转发条件** \> **路径**，然后输入一条或多条路径（例如，`/img/*`）。
    -   **HTTP标头**：选择**添加转发条件** \> **HTTP标头**，然后在**键**字段输入HTTP标头的名称和在**值**字段输入HTTP标头的内容。
    -   **查询字符串**：选择**添加转发条件** \> **查询字符串**，然后输入一个或多个查询字符串的键和值对。

**说明：** 查询字符串键长度为1~100个字符，支持小写字母、可见字符和通配符星号（\*）和问号（？），不支持空格和`#[]{}\|<>&`。查询字符串值长度为1~128个字符，支持小写字母、可见字符和通配符星号（\*）和问号（？），不支持空格和`#[]{}\|<>&`。

    -   **HTTP请求方法**：选择**添加转发条件** \> **HTTP请求方法**，然后输入一个或多个HTTP请求方法。
    -   **Cookie**：选择**添加转发条件** \> **Cookie**，然后输入一个或多个Cookie。

**说明：** Cookie键长度为1~100个字符，支持小写字母、可见字符和通配符星号（\*）和问号（？），不支持空格和`#[]{}\|<>&`。Cookie值长度为1~128个字符，支持小写字母、可见字符和通配符星号（\*）和问号（？），不支持空格和`#[]{}\|<>&`。

**说明：**

    -   同一条件的不同值之间为“或”的关系。即如果一个条件配置了多个值，则任何一个值都可以实现转发。
    -   不同条件之间为“与”的关系。即如果配置了多个条件，则必须同时满足所有条件才能实现转发。 |
    |**添加动作**|添加以下动作之一：    -   **转发至**：选择**添加动作** \> **转发至**，然后从服务器组列表中选择目标服务器组。
    -   **重定向至**：选择**添加动作** \> **重定向至**，然后从**协议**和**状态码**列表选择一个协议和一个状态码，以及分别输入跳转的目的**域名**、**端口**、**路径**和**查询**字符串。
    -   **返回固定响应**：选择**添加动作** \> **返回固定响应**，然后输入**响应状态码**、**响应正文类型**和**响应正文**。
    -   **重写**：选择**添加动作** \> **重写**，然后分别输入跳转的目标**域名**、**路径**和**查询**字符串。
    -   **写入Header**：选择**添加动作** \> **写入Header**，然后输入头字段名称和头字段内容。您也可以开启**覆盖已有变量**开关，覆盖用户请求中已有的头变量。
**说明：** 应用型负载均衡基础版仅支持**转发至**和**写入Header**动作。 |


## 编辑转发规则

您可以随时编辑转发规则的动作和条件。

完成以下操作，编辑转发规则。

1.  登录[负载均衡管理控制台](https://slb.console.aliyun.com/slb)。

2.  在左侧导航栏，选择**应用型负载均衡ALB** \> **实例**。

3.  在实例页面，单击目标实例ID。

4.  单击**监听**页签。

5.  单击目标监听**操作**列下的**查看/编辑转发规则**。

6.  在转发规则页面，选中您要编辑的规则。

7.  单击![编辑](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/5373899061/p210785.png)，修改转发条件和动作，然后单击**保存**。


## 重新排序规则

转发规则按照优先级从高到低开始匹配，数值越小优先级越高。最后评估默认规则。您可以随时更改非默认规则的优先级。您不能更改默认规则的优先级。

1.  登录[负载均衡管理控制台](https://slb.console.aliyun.com/slb)。

2.  在左侧导航栏，选择**应用型负载均衡ALB** \> **实例**。

3.  在实例页面，单击目标实例ID。

4.  单击**监听**页签。

5.  单击目标监听**操作**列下的**查看/编辑转发规则**。

6.  在转发规则页面，将目标转发规则移动到希望的位置，然后单击**保存优先级**。


## 删除转发规则

您可以随时删除监听的非默认转发规则，但您不能删除监听的默认转发规则。当您删除监听时，也会删除它的所有规则。

1.  登录[负载均衡管理控制台](https://slb.console.aliyun.com/slb)。

2.  在左侧导航栏，选择**应用型负载均衡ALB** \> **实例**。

3.  在实例页面，单击目标实例ID。

4.  单击**监听**页签。

5.  单击目标监听**操作**列下的**查看/编辑转发规则**。

6.  在转发规则页面，选中您要删除的转发规则，然后单击![删除](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/5373899061/p210784.png)。

7.  单击**确定删除**。


