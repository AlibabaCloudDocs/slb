---
keyword: [传统型负载均衡实例, ECS实例, CLB, 监听, 后端服务器]
---

# 创建传统型负载均衡实例

负载均衡实例是运行的负载均衡服务实体，通过设置虚拟服务地址，将添加的同一地域的多台ECS实例虚拟成一个高性能和高可用的后端服务池，并根据转发规则，将来自客户端的请求分发给后端服务器池中的ECS实例。本文介绍如何创建一个传统型公网负载均衡实例CLB（Classic Load Balancer），以及配置一个TCP监听并添加部署了静态网页的云服务器ECS（Elastic Compute Service）实例作为后端服务器。

-   您需要创建好部署了静态网页的两个ECS实例（ECS01和ECS02），并搭建应用服务。
-   确保ECS实例的地域和负载均衡实例的地域相同，并且ECS实例的安全组允许端口80或443上的HTTP或HTTPS访问。

## 步骤一：创建传统型负载均衡实例

完成以下操作，创建传统型负载均衡实例。

1.  [登录SLB控制台]()。

2.  在左侧导航栏，选择**传统型负载均衡CLB** \> **实例管理**。

3.  在实例管理页面，单击**创建负载均衡**。

4.  根据以下信息，配置传统型负载均衡实例。

    |配置|说明|
    |:-|:-|
    |**地域和可用区**|选择传统型负载均衡实例的所属地域和可用区。本示例选择**华北2（北京）**和**华北2可用区C**。

**说明：** 确保传统型负载均衡实例的地域和后端添加的云服务器ECS实例的地域相同。 |
    |**可用区类型**|显示所选地域的可用区类型。可用区是属于某个地域的，一个地域下可能有一个或者多个可用区。负载均衡已经在大部分地域部署了多可用区。    -   单可用区：负载均衡实例只部署在一个可用区上。
    -   多可用区：负载均衡实例会部署在两个可用区上。默认启用主可用区的实例。当主可用区出现故障时，将会自动切换到备可用区继续提供负载均衡服务，可以大大提升本地可用性。
本示例默认为**多可用区**。 |
    |**备可用区**|选择负载均衡实例的备可用区。备可用区默认不承载流量。本示例选择**华北2可用区B**。|
    |**实例名称**|自定义新建实例名称。长度限制为1~80个字符，允许包含中文、字母、数字、短划线（-）、正斜线（/）、英文句点（.）和下划线（\_）等字符。 |
    |**实例规格**|选择一个性能规格。

不同的性能规格所提供的性能指标也不同，更多信息，请参见[实例概述](/intl.zh-CN/传统型负载均衡CLB/用户指南/实例/实例概述.md)。 |
    |**实例类型**|根据业务场景选择配置对外公开或对内私有的负载均衡服务，系统会根据您的选择分配公网或私网服务地址。更多信息，请参见[实例概述](/intl.zh-CN/传统型负载均衡CLB/用户指南/实例/实例概述.md)。    -   **公网**：传统型公网负载均衡实例仅提供公网IP，可以通过Internet访问负载均衡。
    -   **私网**：传统型私网负载均衡实例仅提供阿里云私网IP地址或VPC内的地址，只能通过阿里云内部网络访问该负载均衡服务，无法从Internet访问。
本示例选择**公网**。 |
    |**网络类型**|选择一种网络类型：**专有网络**或**经典网络**。。**说明：** 该参数仅在**实例类型**为**私网**时有效。专有网络只提供私网实例。您可购买经典网络公网实例，配合专有网络的ECS实例使用。 |
    |**专有网络**|选择一个专有网络和一台虚拟交换机。**说明：** 该参数仅在**实例类型**为**私网**且**网络类型**为**专有网络**时有效。 |
    |**IP 版本**|本实例默认为**IPv4**。**说明：** 目前支持创建IPv6实例且实例类型必须为性能保障型实例的可用区如下：

    -   华东1地域的E、F两个可用区
    -   华北2地域的F、G两个可用区
    -   华东2地域的D、E两个可用区
    -   华南1地域的D、E两个可用区
    -   华北3地域的A、B两个可用区
    -   中国香港地域的B、C两个可用区
更多信息，请参见[创建IPv6实例](/intl.zh-CN/传统型负载均衡CLB/用户指南/实例/创建IPv6实例.md)。 |
    |**带宽值**|设置一个带宽值。取值范围：1 Mbps~5000 Mbps。|
    |**计费周期**|选择一个计费周期。|
    |**资源组**|云资源所属的资源组。本示例选择默认资源组。|

5.  单击**立即购买**，完成支付。


## 步骤二：配置TCP监听

完成以下操作，为刚创建的传统型负载均衡实例配置TCP监听。

1.  返回实例管理页面，单击要配置监听的目标实例**操作**列下的**监听配置向导**。

2.  在协议&监听配置页面，根据以下信息，配置TCP监听规则，其它配置保持默认选项，然后单击**下一步**。

    |配置|说明|
    |--|--|
    |**选择负载均衡协议**|本示例默认为**TCP**协议。|
    |**监听端口**|用来接收请求并向后端服务器进行请求转发的负载均衡系统的前端协议和端口。 本教程端口设置为**80**。 |
    |**高级配置**|
    |**开启监听带宽限速**|设定不同的带宽峰值来限定后端ECS实例的不同应用所能对外提供的服务能力。本示例创建的公网负载均衡实例是按流量计费的，不受带宽峰值限制，所以不进行配置。 |
    |**调度算法**|负载均衡支持以下三种调度算法，本示例选择**轮询**。     -   加权轮询模式：将访问请求依序分发后端服务器，后端服务器的权重越高，被分发的几率也越大。
    -   加权最小连接数模式：除了根据每台后端服务器设定的权重值来进行轮询，同时还考虑后端服务器的实例连接数。当权重值相同时，当前连接数越小的后端服务器被轮询到的次数也越高。
    -   轮询模式：按照访问顺序将访问请求分发给后端服务器。 |


## 步骤三：配置后端服务器

完成以下操作，配置后端服务器。

1.  在后端服务器配置页面，单击**默认服务器组**页签。

2.  单击**继续添加**，完成以下配置，添加一台默认服务器，然后单击**下一步**

    1.  在我的服务器页面，勾选之前创建的ECS01和ECS02实例，单击**下一步**。

    2.  配置权重，权重越大转发的请求越多，默认为100，保持默认值即可。

    3.  单击**添加**。

    4.  在**默认服务器**页签下，配置后端协议端口，ECS实例上开放的用来接收请求的后端端口，在同一个负载均衡实例内可重复。本示例端口设置为80。


## 步骤四：配置健康检查

完成以下操作，配置健康检查。

1.  在健康检查配置页面，完成以下配置，然后单击**下一步**。

    |健康检查配置|说明|
    |:-----|:-|
    |**开启健康检查**|打开**开启健康检查**开关。|
    |**高级配置**|
    |**健康检查协议**|选择健康检查协议类型，监听为TCP协议时，健康检查方式可选TCP或HTTP模式。

    -   TCP模式的健康检查是基于网络层探测，通过发送SYN握手报文来检测服务器端口是否存活。
    -   HTTP模式的健康检查是通过发送Head请求，通过发送HEAD或GET请求模拟浏览器的访问行为来检查服务器应用是否健康。
本示例默认为**TCP**。 |
    |**健康检查端口**|健康检查服务访问后端时的探测端口。默认值为配置监听时指定的后端端口。

**说明：** 如果该监听配置了虚拟服务器组或主备服务器组，且组内的ECS实例的端口都不相同，此时不需要配置检查端口。负载均衡系统会使用各自ECS的后端端口进行健康检查。 |
    |**健康检查响应超时时间**|接收来自运行状况检查的响应需要等待的时间。如果后端ECS在指定的时间内没有正确响应，则判定为健康检查失败。 范围是1~300秒，UDP监听的默认值为10秒，HTTP、HTTPS和TCP监听的默认值为5秒。 |
    |**健康检查间隔时间**|进行健康检查的时间间隔。LVS集群内所有节点，都会独立、并行地遵循该属性对后端ECS进行健康检查。由于各LVS节点的检查时间并不同步，所以，如果从后端某一ECS上进行单独统计，会发现来自负载均衡的健康检查请求在时间上并不会遵循上述时间间隔。

范围是1~50秒，UDP监听的默认值为5秒，HTTP、HTTPS和TCP监听的默认值为2秒。 |
    |**健康检查健康阈值**|同一LVS节点服务器针对同一ECS服务器，从失败到成功的连续健康检查成功次数。 可选值2~10，默认为3次。 |
    |**健康检查不健康阈值**|同一LVS节点服务器针对同一ECS服务器，从成功到失败的连续健康检查失败次数。 可选值2~10，默认为3次。 |


## 步骤五：配置审核

完成以下操作，审核配置信息。

1.  在配置审核页面，确认配置信息，然后单击**提交**。

2.  单击**知道了**，返回实例管理页面，单击![](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/2724068951/p7518.png)。

    当后端ECS的健康检查状态为**正常**时，表示后端ECS可以正常处理负载均衡转发的请求了。

    ![](../images/p7519.png "实例管理-2")


